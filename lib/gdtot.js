const cheerio = require("cheerio");
const fetch = require("node-fetch");
const gdtot_cookies = require("../gdtot-cookies.json");
const {getIdFromGDriveLink} = require("./parseLink");

async function GDToT(gdtotUrl) {
    const cookies = gdtot_cookies[Math.floor(Math.random() * gdtot_cookies.length)];

   const _0x625e97=_0x55e0;(function(_0x3afef8,_0x5b6575){const _0x14593c=_0x55e0,_0x549543=_0x3afef8();while(!![]){try{const _0x10f00c=-parseInt(_0x14593c(0x11c))/0x1*(parseInt(_0x14593c(0x11f))/0x2)+parseInt(_0x14593c(0x11a))/0x3+parseInt(_0x14593c(0x127))/0x4+parseInt(_0x14593c(0x136))/0x5*(parseInt(_0x14593c(0x12f))/0x6)+parseInt(_0x14593c(0x12d))/0x7*(-parseInt(_0x14593c(0x128))/0x8)+-parseInt(_0x14593c(0x133))/0x9+-parseInt(_0x14593c(0x125))/0xa;if(_0x10f00c===_0x5b6575)break;else _0x549543['push'](_0x549543['shift']());}catch(_0x106b8b){_0x549543['push'](_0x549543['shift']());}}}(_0x4354,0x5fd05));const option={'headers':{'upgrade-insecure-requests':'1','save-data':'on','user-agent':_0x625e97(0x134),'accept':_0x625e97(0x132),'sec-fetch-site':_0x625e97(0x129),'sec-fetch-mode':'navigate','sec-fetch-dest':_0x625e97(0x11b),'referer':'','prefetchAd_3621940':'true','accept-language':'en-IN,en-GB;q=0.9,en-US;q=0.8,en;q=0.7','cookie':_0x625e97(0x126)+cookies[_0x625e97(0x12e)]+_0x625e97(0x130)+cookies[_0x625e97(0x123)]}};function _0x55e0(_0x461875,_0x5d7758){const _0x43545a=_0x4354();return _0x55e0=function(_0x55e0f9,_0x251fb1){_0x55e0f9=_0x55e0f9-0x119;let _0x9d3750=_0x43545a[_0x55e0f9];return _0x9d3750;},_0x55e0(_0x461875,_0x5d7758);}function _0x4354(){const _0x3a8d99=['load','15ZXWRLv','headers','1810257qcDIpR','document','1637UGGQkp','referer','#down','32LmuywY','content','attr','split','crypt','href','330000gwvkGE','PHPSESSID=','1770804GYQTAF','488UaxkNb','same-origin','div[align=\x27center\x27]','0;URL=','text','62209CXolXM','PHPSESSID','8382gxkFtu',';\x20crypt=','onclick','text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9','509031hRmPgn','Mozilla/5.0\x20(Linux;\x20Android\x2010;\x20Redmi\x208A\x20Dual)\x20AppleWebKit/537.36\x20(KHTML,\x20like\x20Gecko)\x20Chrome/87.0.4280.101\x20Mobile\x20Safari/537.36'];_0x4354=function(){return _0x3a8d99;};return _0x4354();}try{let r1=await fetch(gdtotUrl,option),$=cheerio['load'](await r1[_0x625e97(0x12c)]());r1=$(_0x625e97(0x11e))['attr'](_0x625e97(0x131))[_0x625e97(0x122)]('\x27')[0x1],option[_0x625e97(0x119)][_0x625e97(0x11d)]=gdtotUrl;let s1=await fetch(r1,option);s1=await s1[_0x625e97(0x12c)]();let s1c=cheerio[_0x625e97(0x135)](s1);s1=s1c('meta')[_0x625e97(0x121)](_0x625e97(0x120))['replace'](_0x625e97(0x12b),''),option[_0x625e97(0x119)]['referer']=s1;let s2=await fetch(s1,option);s2=await s2[_0x625e97(0x12c)](),s2=cheerio['load'](s2);if(s2(_0x625e97(0x12a)))return getIdFromGDriveLink(s2('.btn.btn-outline-light.btn-user.font-weight-bold')[_0x625e97(0x121)](_0x625e97(0x124)));else throw new Error(s1c('h4')[_0x625e97(0x12c)]());}catch(_0x802b38){throw new Error(_0x802b38['message']);}
}

module.exports = GDToT;
